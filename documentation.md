
# Pump Yourself server documentation


## Типы запросов к серверу

* [Запросы о еде](#запросы-о-еде)
* [Запросы о тренировках](#запросы-о-тренировках)
* [Запросы о группах](#запросы-о-группах)
* [Запросы о пользователях](#запросы-о-пользователях)
* [Получение изображения](#получение-изображения)

## Запросы о еде

### Получение всей еды пользователя за период

Запрос: `GET /meal/getallfood`

Параметры запроса:

* user_id - Идентификатор пользователя
* start_date - Начальная дата периода (включительно) (YYYY-MM-DD)
* end_date - Конечная дата периода (не включительно) (YYYY-MM-DD)

Тело ответа сервера:

```
[
    {
        User_dish_ID: <Number>,         // Идентификатор факта приема пищи
        Dish_ID: <Number>,              // Идентификатор блюда
        Weight: <Number>,               // Вес
        Eating_date: <Date>,            // Дата приема пищи (YYYY-MM-DDTHH:MM:SS.SSSZ)
        Photo_ID: <String>,             // Идентификатор фотографии блюда
        Dish_name: <String>,            // Имя блюда
        Proteins: <Number>,             // Количество белков
        Fats: <Number>,                 // Количество жиров
        Carbohydrates: <Number>,        // Количество углеводов
        Calories: <Number>              // Количество калорий
    },
    ...
]
```

### Добавление факта приема пищи пользователем

Запрос: `POST /meal/addeating`

Тело запроса:

```
{
    user_id: <Number>,          // Идентификатор пользователя
    date: <Date>,               // Дата отправки запроса (YYYY-MM-DDTHHMMSS)
    name: <String>,             // Название блюда
    weight: <Number>,           // Вес блюда
    photo: <Buffer in JSON>,    // Фотография блюда*
    proteins: <Number>,         // Количество грамм белков на 100 грамм блюда
    fats: <Number>,             // Количество грамм жиров на 100 грамм блюда
    carbohydrates: <Number>,    // Количество грамм углеводов на 100 грамм блюда
    calories: <Number>          // Количество калорий на 100 грамм блюда
}
```

\* - Если было выбрано стандартное блюдо и оно не было изменено, фотография не присылается

Тело ответа сервера:
<Number> - Идентификатор факта приема пищи

### Редактирование факта приема пищи

Запрос: `POST /meal/editeating`

Тело запроса:

```
{
    user_id: <Number>,          // Идентификатор пользователя
    user_dish_id: <Number>      // Идентификатор факта приема пищи
    date: <Date>,               // Дата отправки запроса (YYYY-MM-DDTHHMMSS)
    name: <String>,             // Название блюда
    weight: <Number>,           // Вес блюда
    photo: <Buffer in JSON>,    // Фотография блюда*
    proteins: <Number>,         // Количество грамм белков на 100 грамм блюда
    fats: <Number>,             // Количество грамм жиров на 100 грамм блюда
    carbohydrates: <Number>,    // Количество грамм углеводов на 100 грамм блюда
    calories: <Number>          // Количество калорий на 100 грамм блюда
}
```

\* - Фотография присылается только в случае её изменения

Тело ответа сервера отсутствует

### Удаление факта приема пищи

Запрос: `POST /meal/deleteeating`

Тело запроса:

```
{
    user_dish_id: <Number>,     // Идентификатор факта приема пищи
}
```

Тело ответа сервера отсутствует


## Запросы о тренировках

### Получение всех тренировок пользователя

Запрос: `GET /trainings/getallusertrainings`

Параметры запроса:

* user_id - Идентификатор пользователя

Тело ответа сервера:

```
[
    {
        Training_ID: <Number>               // идентификатор тренировки
        Training_name: <String>             // имя тренировки
        Training_description: <String>      // описание тренировки
        Start_date: <Date>                  // дата начала тренировки (YYYY-MM-DD)
        Day_number: <Number>                // Номер дня
        Day_plan: <String>                  // Описание тренировки в этот день
    },
    ...
]
```

### Получение всех публичных тренировок

Запрос: `GET /trainings/getallpublictrainings`

Параметры запроса отсутствуют

Тело ответа сервера:

```
[
    {
        Training_ID: <Number>               // идентификатор тренировки
        Training_name: <String>             // имя тренировки
        Training_description: <String>      // описание тренировки
        Day_number: <Number>                // Номер дня
        Day_plan: <String>                  // Описание тренировки в этот день
    },
    ...
]
```

### Создание тренировки

Пользователь автоматически НЕ подписывается на созданную тренировку. Тренировка должна содержать хотя бы один день

Запрос: `POST /trainings/createtraining`

Тело запроса:

```
[
    {
        training_name: <String>             // имя тренировки
        training_description: <String>      // описание тренировки
        day_number: <Number>                // Номер дня
        day_plan: <String>                  // Описание тренировки в этот день
    },
    ...
]
```

Тело ответа сервера:
<Number> - Идентификатор новой тренировки


### Подписка на тренировку

Запрос: `POST /trainings/starttraining`

Тело запроса:

```
{
    user_id: <Number>,                // Идентификатор пользователя
    training_id: <Number>,            // Идентификатор тренировки
    date: <Date>                      // Дата начала тренировки (YYYY-MM-DD)
}
```

Тело ответа сервера отсутствует


### Отписка от тренировки

Запрос: `POST /trainings/stoptraining`

Тело запроса:

```
{
    user_id: <Number>,                // Идентификатор пользователя
    training_id: <Number>,            // Идентификатор тренировки
}
```

Тело ответа сервера отсутствует


## Запросы о группах

### Получение всех групп пользователя

Выдается только поверхностная информация о группах

Запрос: `GET /groups/getallusergroups`

Параметры запроса:

* user_id - Идентификатор пользователя

Тело ответа сервера:

```
[
    {
        Group_ID: <Number>              // идентификатор группы*
        Group_name: <String>            // имя группы
        Group_description: <String>     // описание группы
    },
    ...
]
```
\* Идентификатор группы является также идентификатором фотографии группы

### Получение подробной информации о группе

Используется, когда поверхностная информация о группе уже известна и необходимо подгрузить дополнительные данные (члены группы и информаци о тренировке)

Запрос: `GET /groups/getmoregroupinfo`

Параметры запроса:

* group_id - Идентификатор группы

Тело ответа сервера:

```
{
    Members: [                  // члены группы
        {                     
            User_ID: <Number>           // Идентификатор пользователя
            User_name: <String>         // Имя пользователя
        },
        ...
    ]

    Training: [                 // план тренировки
        {
            Training_ID: <Number>       // идентификатор тренировки
            Start_date: <Date>          // дата начала тренировки (YYYY-MM-DD)
            Day_number: <Number>        // Номер дня
            Day_plan: <String>          // Описание тренировки в этот день
        },
        ...
    ]
}
```

### Создание группы

Запрос необходимо отправлять после создания тренировки. Пользователь автоматически вступает в созданную группу

Запрос: `POST /groups/addgroup`

Тело запроса:

```
{
    user_id: <Number>           // Идентификатор пользователя
    group_name: <String>,       // Имя группы
    description: <String>,      // Описание группы
    photo: <Buffer in JSON>,    // Фотография группы*
    training_id: <Number>       // Идентификатор тренировки
    start_date: <Date>          // дата начала тренировки (YYYY-MM-DD)
}
```

\* - Фотография может отсутствовать

Тело ответа сервера:
<Number> - Идентификатор новой группы


### Редактирование группы

Запрос: `POST /groups/editgroup`

Тело запроса:

```
{
    group_id: <Number>          // Идентификатор группы
    name: <String>,             // Имя группы
    description: <String>,      // Описание группы
    photo: <Buffer in JSON>,    // Фотография группы*
}
```

\* - Фотография может отсутствовать

Тело ответа сервера отсутствует


### Приглашение друга в группу

Запрос: `POST /groups/invitefriendintogroup`

Тело запроса:

```
{
    user_id: <Number>,                // Идентификатор пользователя
    friend_id: <Number>,              // Идентификатор друга
    group_id: <Number>                // Идентификатор группы    
}
```

Тело ответа сервера отсутствует


### Выход из группы

Запрос: `POST /groups/leavethegroup`

Тело запроса:

```
[
    user_id: <Number>,                // Идентификатор пользователя
    group_id: <Number>                // Идентификатор группы    
]
```

Тело ответа сервера отсутствует


## Запросы о пользователях

### Получение информации о профиле пользователя

Запрос: `GET /profile/getprofileinfo`

Параметры запроса:

* user_id - Идентификатор пользователя

Тело ответа сервера:

```
{
    User_name: <String>                  // имя пользователя
    User_status: <String>                // статус пользователя
    Friends_requests: [         // запросы на добавление в друзья
        {
            Friend_ID: <Number>                  // идентификатор пользователя друга
            User_name: <String>                  // имя друга
            User_status: <String>                // статус друга
        },
        ...
    ]
    Groups_requests: [         // приглашения в группу
        {
            Group_ID: <Number>                    // идентификатор группы
            Group_name: <String>                  // имя группы
            Group_description: <String>           // описание группы
        },
        ...
    ]
    Friends: [                      // друзья
        {
            Friend_ID: <Number>                  // идентификатор пользователя друга
            User_name: <String>                  // имя друга
            User_status: <String>                // статус друга
        },
        ...
    ]
}
```

### Получение дополнительной информации о профиле друга

Используется, когда необходимо подгрузить дополнительную информацию о профиле друга. Подразумевается, что имя пользователя, его статус и фотография уже известны.

Запрос: `GET /profile/getfriendinfo`

Параметры запроса:

* user_id - Идентификатор пользователя, который посылает запрос
* friend_id - Идентификатор пользователя друга

Тело ответа сервера:

```
{
    Friends: [                      // друзья друга
        {
            Friend_ID: <Number>                  // идентификатор пользователя друга
            User_name: <String>                  // имя друга
            User_status: <String>                // статус друга
        },
        ...
    ]
    Mutual_groups: [                // общие группы
        {
            Group_ID: <Number>                    // идентификатор группы
            Group_name: <String>                  // имя группы
            Group_description: <String>           // описание группы
        },
        ...
    ]
}
```

### Поиск пользователей по фразе

Используется во время поиска друзей. Производится поиск пользователей, имя которых включает в себя введенный текст.

Запрос: `GET /profile/searchuser`

Параметры запроса:

* phrase - Текст, по которому осуществляется поиск

Тело ответа сервера:

```
[
    {
        User_ID: <Number>           // Идентификатор найденного пользователя
        User_name: <String>         // Имя пользователя
        User_status: <String>       // Статус пользователя
    },
    ...
]
```

### Добавление нового пользователя

Запрос: `POST /profile/addnewuser`

Тело запроса:

```
{
    login: <String>,            // Имя пользователя
    password: <String>,         // Статус пользователя
    name: <String>,             // Имя пользователя
    status: <String>,           // Статус пользователя
    photo: <Buffer in JSON>,    // Фотография пользователя*
}
```

\* - Фотография может отсутствовать

Тело ответа сервера:
<Number> - Идентификатор нового пользователя

### Редактирование информации о пользователе

Подразумевает редактирование имени пользователя, статуса и фотографии

Запрос: `POST /profile/changeprofileinfo`

Тело запроса:

```
{
    user_id: <Number>,          // Идентификатор пользователя    
    name: <String>,             // Имя пользователя
    status: <String>,           // Статус пользователя
    photo: <Buffer in JSON>,    // Фотография пользователя*
}
```

\* - Фотография присылается только в случае её изменения

Тело ответа сервера отсутствует


### Принятие/отклонение запроса в группу

Запрос: `POST /profile/acceptgrouprequest`  (для принятия)
Запрос: `POST /profile/declinegrouprequest` (для отклонения)

Тело запроса:

```
{
    user_id: <Number>,           // Идентификатор пользователя
    group_id: <Number>           // Идентификатор группы
}
```

Тело ответа сервера отсутствует


### Принятие/отклонение запроса в друзья

Запрос: `POST /profile/acceptfriendrequest`  (для принятия)
Запрос: `POST /profile/declinefriendrequest` (для отклонения)

Тело запроса:

```
{
    user_id: <Number>,           // Идентификатор пользователя
    friend_id: <Number>          // Идентификатор пользователя друга
}
```

Тело ответа сервера отсутствует


### Отправка запроса в друзья

Запрос: `POST /profile/sendfriendrequest`

Тело запроса:

```
{
    user_id: <Number>,           // Идентификатор пользователя
    friend_id: <Number>          // Идентификатор пользователя друга
}
```

Тело ответа сервера отсутствует


### Удаление из друзей

Запрос: `POST /profile/removefriend`

Тело запроса:

```
{
    user_id: <Number>,           // Идентификатор пользователя
    friend_id: <Number>          // Идентификатор пользователя друга
}
```

Тело ответа сервера отсутствует


### Вход в аккаунт

Запрос: `GET /profile/login`

Параметры запроса:

* login - логин
* password - пароль

Тело ответа сервера:

```
{
    user_id: <Number>,           // Идентификатор пользователя*
}
```

\* - В случае неудачной аутентификации возвращается значение -1


## Получение изображения

Запрос: `GET /images/dishes`        (вместо dishes может быть также groups и users)

Параметры запроса:

* image_id - идентификатор изображения

